<%= form_with(model: booking, local: true) do |form| %>
  <%= render 'shared/error_messages', object: form.object %>

  <div class="row">
    <div class="col-md-2 form-group">
      <%= form.date_field :start, class: 'form-control' %>
    </div>

    <div class="col-md-2 form-group">
      <%= form.date_field :finish, class: 'form-control' %>
    </div>
    <div class="col-md-2 form-group">
      <%= form.select :house_id,
            @houses.all.map {|h| ["#{h.code} #{'(not for rent)' if h.unavailable}", h.id]},
                      { prompt: 'Select house' }, { class: "form-control",  } %>
    </div>
    <div class="col-md-2 form-group">
      <%= form.select :status, ['temporary','pending','confirmed', 'block', 'canceled'], {}, { class: "form-control"} %>
    </div>
    <div class="col-md-2 form-group">
      <%= form.select :source_id,
            Source.all.map {|s| [s.name, s.id]},
                      { include_blank: 'Our booking' }, { class: "form-control",  } %>
    </div>

  </div>


  <div class='row'>
    <div class="col-md-6 form-group">
      <%= form.label :client_details %>
      <%= form.text_field :client_details, placeholder: 'Name Surname, pax, phone, email', class: 'form-control' %>
    </div>
  </div>

  <div class="row">
    <div class="col-md-2 form-group">
      <%= form.label :sale %>
      <%= form.number_field :sale, class: 'form-control calcs' %>
      <small>Origial: <%= @booking_original.sale if !@booking_original.nil? %></small>
    </div>
    <div class="col-md-2 form-group">
      <%= form.label :agent %>
      <%= form.number_field :agent, class: 'form-control calcs' %>
    </div>
    <div class="col-md-2 form-group">
      <%= form.label :comm %> <span id='comm_percent'><%= ((@booking.agent+@booking.comm)/@booking.sale.to_f*100).round(2) if !@booking_original.nil? %></span> %
      <%= form.number_field :comm, class: 'form-control calcs' %>
      <small>Origial: <%= @booking_original.comm if !@booking_original.nil? %></small><br />
    </div>
    <div class="col-md-2 form-group">
      <%= form.label :nett %>
      <%= form.number_field :nett, class: 'form-control calcs' %>
      <small>Origial: <%= @booking_original.nett if !@booking_original.nil? %></small>
    </div>
  </div>

  <div class="row">
    <div class="col form-group">
      <%= form.label 'Comment inner (owner will not see)' %>
      <%= form.text_area :comment, class: 'form-control', rows: 2 %>
    </div>
  </div>
  <div class="row">
    <div class="col form-group">
      <%= form.label 'Comment for owner' %>
      <%= form.text_area :comment_owner, class: 'form-control', rows: 2 %>
    </div>
  </div>
  <div class="row">
    <div class="col form-group">
      <%= form.label 'Comment for guest relation' %>
      <%= form.text_area :comment_gr, class: 'form-control', rows: 2 %>
    </div>
  </div>

  <div class="row">
    <div class="col-md-2 form-group">
      <%= form.label 'Check in date if other from booking start' %>
      <%= form.date_field :check_in, class: 'form-control calcs' %>
    </div>
    <div class="col-md-2 form-group">
      <%= form.label 'Check out date if other from booking finish' %>
      <%= form.date_field :check_out, class: 'form-control calcs' %>
    </div>
  </div>

  <div class="form-check form-check-inline">
    <%= form.check_box :allotment, { class: 'form-check-input',
                            id: 'unavailable_check_box' } %>
    <%= form.label :allotment, {     class: 'form-check-label',
                            for: 'unavailable_check_box' } %>
  </div>
  <div class="form-check form-check-inline">
    <%= form.check_box :no_check_in, { class: 'form-check-input',
                            id: 'no_check_in_check_box' } %>
    <%= form.label :no_check_in, {     class: 'form-check-label',
                            for: 'no_check_in_check_box' } %>
  </div>
  <div class="form-check form-check-inline">
    <%= form.check_box :no_check_out, { class: 'form-check-input',
                            id: 'no_check_out_check_box' } %>
    <%= form.label :no_check_out, {     class: 'form-check-label',
                            for: 'no_check_out_check_box' } %>
  </div>

  <%#= hidden_field_tag :house_id, @booking.house.id if @booking %>
  <div  class='mt-3'>
      <%= form.submit 'Save booking', class: 'btn btn-primary' %>
      <% if @booking.house %>
        <%= link_to 'Back', house_bookings_path(@booking.house.number), class: 'btn btn-secondary' %>
      <% else %>
        <%= link_to 'Back', bookings_path, class: 'btn btn-secondary' %>
      <% end %>
  </div>
<% end %>
