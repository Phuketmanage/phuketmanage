<h1>Timeline</h1>

<%= link_to 'Bookings (table view)', bookings_path %> |
<% if params[:period].present? %>
  <%= link_to 'Bookings (timeline full view)', bookings_timeline_path %>
<% else %>
  <%= link_to 'Bookings (timeline short view)', bookings_timeline_path(period: 45) %>
<% end %>

<%= form_with do |f| %>
  <div class="form-check mb-2">
    <%= f.check_box :compact_view, { class: 'form-check-input',
                            id: 'compact_check_box' } %>
    <%= f.label 'Compact view', {     class: 'form-check-label',
                            for: 'compact_check_box' } %>
  </div>
<% end %>

<div class="timeline">
  <div class="timeline_top_container">
    <% @days.times do |i| %>
      <% date = @today+i.days %>
      <% day = date.day %>
      <% month_end = date.end_of_month.day %>
      <% if (i == 0 && day > 1) || day == 1 %>
        <div class='month_date'> <!-- Open month -->
          <div class='month'><%= date.strftime('%B') %></div>
      <% end %>
      <div class="date">
        <%= day %>
      </div>
      <% if day == month_end || i+1 == @days %>
        </div> <!-- Close month -->
      <% end %>
    <% end %>
  </div>

  <div class="timeline_left_container">
    <% @houses.each do |h| %>
      <div class="house_code <%= 'text-muted' if h.unavailable? %>">
        <%= h.code %>
      </div>
    <% end %>
  </div>
  <div class="timeline_container">
    <% @houses.each_with_index do |h, y| %>
      <div class="house_line">
      <% @days.times do |x| %>
        <div class="cell" id=<%= "x#{x+1}y#{y+1}" %>>
        </div>
      <% end %>
      <div>
    <% end %>
  </div>
</div>
