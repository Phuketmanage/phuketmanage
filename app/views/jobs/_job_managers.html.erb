<div class="row shadow-sm mb-2 p-2 bg-light rounded" id="job_<%= job.id %>">
  <div class="col">
    <div class="row">
      <div class="col">
        <div class="d-inline-block">
          <span class='text-muted'>Created:</span>
          <%= " #{job.created_at.strftime('%d.%m.%Y')}" %>
        </div>
        <div class="d-inline-block">
          <span class='text-muted'>Plan:</span>
          <%= "#{job.plan.strftime('%d.%m.%Y')} #{job.time}" if job.plan %>
        </div>
        <% if job.closed %>
          <div class="d-md-inline-block">
            <span class='text-muted'>Closed:</span>
            <%= job.closed.strftime('%d.%m.%Y') %>
          </div>
        <% end %>
        <% if current_user.role? :admin %>
          <div class="d-md-inline-block">
            <span class='text-muted'>Created:</span>
            <%= job.user.name if job.user_id %>
          </div>
        <% end %>

          <div class="d-md-inline-block">
            <% if (job.creator == current_user) || current_user.role?(:admin) %>
              <%= link_to 'Edit', edit_job_path(job) %> |
            <% end %>
            <% if (job.creator == current_user) || current_user.role?(:admin) %>
              <%= link_to 'Destroy', job, method: :delete, data: { confirm: 'Are you sure?' } %> |
            <% end %>

            <% if job.closed.nil? %>
              <%= link_to 'Done', job_path(job, done: true), method: :put, remote: true %>
            <% else %>
              <%= link_to 'Undone', job_path(job, done: false), method: :put, remote: true %>
            <% end %>
          </div>
      </div>
    </div>
    <% if current_user.role? :admin %>
      <div>
        <%= form_with(model: job, class: "update_job") do |f| %>
          <%= f.label :job, class: 'text-muted' %>
          <%= f.text_area :job, class: 'form-control', row: 2,
            data: {job_id: job.id, field: 'job'} %>
        <% end %>
      </div>
      <span class='text-muted'>Comment:</span> <%= job.comment %>
    <% else %>
      <span class='text-muted'>Job:</span> <%= job.job %>
      <div class="mt-2">
        <%= form_with(model: job, class: "update_job") do |f| %>
          <%= f.text_area :comment, class: 'form-control', row: 2,
            data: {job_id: job.id, field: 'comment'} %>
          <%= f.submit 'Save', {  class: "btn btn-primary mt-2",
                                  id: "btn_job_#{job.id}",
                                  style: "display: none;"} %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
